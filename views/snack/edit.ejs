<%- include('../base/head.ejs') %>
  <title>Update Snack</title>

  <body>
    <header><%- include('../base/header.ejs') %></header>
    <div class="container nav-padding">
      <div class="d-flex justify-content-between align-items-center">
        <h3>Update Snack Product</h3>
      </div>
      <form action="/snacks/<%= snack._id %>?_method=PUT" method="POST">
        <div class="row">
          <div class="col-md-6">
            <div class="mt-1">
                <label for="name" class="col-form-label" style="font-size:16px;">Name:</label>
                <input type="text" id="name" name="name" class="form-control" value="<%= snack.name %>" required>
              </div>
            <div class="mt-1">
                <label for="description" class="col-form-label" style="font-size:16px;">Description:</label>
                <textarea id="description" name="description" class="form-control" rows="2"><%= snack.description %></textarea>
              </div>
            <div class="mt-1">
                <label for="price" class="col-form-label" style="font-size:16px;">Price:</label>
                <input type="number" id="price" name="price" class="form-control" value="<%= snack.price %>" required>
              </div>
            <div class="mt-1">
                <label for="quantity" class="col-form-label" style="font-size:16px;">Quantity:</label>
                <input type="number" id="quantity" name="quantity" class="form-control" value="<%= snack.quantity %>">
              </div>
            <button type="submit" style="width: 30%" class="btn btn-primary">Submit</button>
            <span><button type="button" class="btn btn-secondary" style="width: 30%;" onclick="window.history.back();">Cancel</button></span>
          </div>
         <!-- Image Preview -->          
          <div class="col-md-6">
            <div class="mt-1">
              <label for="image" class="col-form-label" style="font-size:16px;">Image:</label>
              <input class="form-control" type="file" id="image" name="imagePath">
              <label for="image-preview" class="col-form-label" style="font-size:16px;">Image Preview:</label>
              <div class="mb-2">
                <img id="image-preview" src="<%= snack.image %>" class="custom-imgPreview">
              </div>
            </div>
          </div>
        </div>     
      </form>
    </div>

    <script>
      // JavaScript to preview the previous image
      document.getElementById('image').addEventListener('change', function (event) {
        const file = event.target.files[0]; // Get the selected file
        if (file) {
          const reader = new FileReader(); // Create a FileReader instance
          reader.onload = function (e) {
            document.getElementById('image-preview').src = e.target.result; // Update the preview image
          };
          reader.readAsDataURL(file); // Read the file as a data URL for preview
        }
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"></script>
  </body>

  </html>